<div class="registration-container">
  <div class="card register-card">
    <div class="card-body">
      <h2 class="text-center mb-4">Create Your Account</h2>

      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="needs-validation" novalidate>
        <!-- Name Field -->
        <div class="mb-3">
          <label for="name" class="form-label">Full Name</label>
          <input type="text" class="form-control" id="name" formControlName="name" placeholder="Enter your full name"
            [ngClass]="{ 'is-invalid': registerForm.get('name')?.invalid && registerForm.get('name')?.touched }">
          <div *ngIf="registerForm.get('name')?.invalid && registerForm.get('name')?.touched" class="invalid-feedback">
            <div *ngIf="registerForm.get('name')?.errors?.['required']">
              Name is required
            </div>
            <div *ngIf="registerForm.get('name')?.errors?.['minlength']">
              Name must be at least 3 characters
            </div>
          </div>
        </div>

        <!-- Email Field -->
        <div class="mb-3">
          <label for="email" class="form-label">Email</label>
          <input type="email" class="form-control" id="email" formControlName="email" placeholder="Enter your email"
            [ngClass]="{ 'is-invalid': registerForm.get('email')?.invalid && registerForm.get('email')?.touched }">
          <div *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched"
            class="invalid-feedback">
            <div *ngIf="registerForm.get('email')?.errors?.['required']">
              Email is required
            </div>
            <div *ngIf="registerForm.get('email')?.errors?.['email']">
              Please enter a valid email
            </div>
          </div>
        </div>

        <!-- Password Field -->
        <div class="mb-3">
          <label for="password" class="form-label">Password</label>
          <input type="password" class="form-control" id="password" formControlName="password"
            placeholder="Create a password"
            [ngClass]="{ 'is-invalid': registerForm.get('password')?.invalid && registerForm.get('password')?.touched }">
          <div *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched"
            class="invalid-feedback">
            <div *ngIf="registerForm.get('password')?.errors?.['required']">
              Password is required
            </div>
            <div *ngIf="registerForm.get('password')?.errors?.['minlength']">
              Password must be at least 6 characters
            </div>
            <div *ngIf="registerForm.get('password')?.errors?.['pattern']">
              Password must contain at least one number and one special character
            </div>
          </div>
        </div>

        <!-- Confirm Password Field -->
        <div class="mb-3">
          <label for="confirmPassword" class="form-label">Confirm Password</label>
          <input type="password" class="form-control" id="confirmPassword" formControlName="confirmPassword"
            placeholder="Confirm your password"
            [ngClass]="{ 'is-invalid': registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched }">
          <div *ngIf="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched"
            class="invalid-feedback">
            <div *ngIf="registerForm.get('confirmPassword')?.errors?.['required']">
              Please confirm your password
            </div>
          </div>
          <div *ngIf="registerForm.hasError('mismatch') && registerForm.get('confirmPassword')?.touched"
            class="invalid-feedback d-block">
            Passwords do not match
          </div>
        </div>

        <!-- Profile Picture Upload -->
        <div class="mb-3">
          <label for="profilePicture" class="form-label">Profile Picture</label>
          <input type="file" class="form-control" id="profilePicture" (change)="onFileChange($event)" accept="image/*">
          <div class="form-text">Upload a profile picture (optional)</div>
          <div *ngIf="previewUrl" class="mt-2">
            <img [src]="previewUrl" alt="Profile preview" class="img-thumbnail" width="100">
          </div>
        </div>

        <!-- Submit Button -->
        <div class="d-grid mb-3">
          <button type="submit" class="btn btn-primary" [disabled]="registerForm.invalid || isLoading">
            <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-1"></span>
            Register
          </button>
        </div>

        <!-- Login Link -->
        <div class="text-center">
          <span class="text-muted">Already have an account?</span>
          <a routerLink="/login" class="ms-2">Sign in</a>
        </div>
      </form>
    </div>
  </div>
</div>
